<!DOCTYPE html>
<html lang="ar" dir="rtl">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>حسابي - متركنهاش</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Cairo:wght@400;600;700;800&display=swap" rel="stylesheet">
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/lottie-web/5.12.2/lottie.min.js"></script>
    <link rel="stylesheet" href="/assets/css/main.css">
    <link rel="stylesheet" href="/assets/css/profile.css">
</head>

<body style="font-family: 'Cairo', sans-serif; background: var(--bg); margin: 0;">

    <!-- Order Success Overlay -->
    <div id="successOverlay" class="success-overlay" style="display: none;">
        <div class="success-card">
            <div id="successAnimation" style="width: 200px; height: 200px; margin: 0 auto;"></div>
            <h2 style="font-size: 1.8rem; font-weight: 800; color: var(--primary); margin-bottom: 0.5rem;">تم طلبك
                بنجاح!
            </h2>
            <p style="color: #666; margin-bottom: 2rem;">جاري تجهيز طلبك الآن وشحنه في أسرع وقت. يمكنك متابعة الحالة من
                قسم طلباتي.</p>
            <button onclick="dismissSuccess()"
                style="background: var(--primary); color: white; border: none; padding: 12px 30px; border-radius: 12px; font-weight: bold; cursor: pointer; width: 100%;">فهمت
                ذلك</button>
        </div>
    </div>

    <header class="header">
        <div class="header-content">
            <div style="display: flex; align-items: center; gap: 15px;">
                <div class="avatar" id="avatarLetter">U</div>
                <div>
                    <h1 id="userNameLabel" style="margin: 0; font-size: 1.2rem; font-weight: 800;">جاري التحميل...</h1>
                    <p id="userEmailLabel" style="margin: 0; font-size: 0.85rem; opacity: 0.6;"></p>
                </div>
            </div>
            <div style="display: flex; gap: 10px;">
                <button onclick="window.location.href='/'"
                    style="background: #f0f2f5; border: none; padding: 8px 15px; border-radius: 10px; font-weight: bold; cursor: pointer; display: flex; align-items: center; gap: 8px; font-size: 0.85rem;">
                    <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"
                        stroke-linecap="round" stroke-linejoin="round">
                        <path d="M3 9l9-7 9 7v11a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z"></path>
                        <polyline points="9 22 9 12 15 12 15 22"></polyline>
                    </svg>
                    الرئيسية
                </button>
                <button onclick="logout()"
                    style="background: #fff0f0; border: none; color: #ff4d4f; padding: 8px 20px; border-radius: 10px; font-weight: bold; cursor: pointer;">خروج</button>
            </div>
        </div>
    </header>

    <main class="main-container">
        <!-- Sidebar Navigation -->
        <aside class="sidebar">
            <div class="menu-item active" id="tab-orders" onclick="showTab('orders')"
                style="display:flex; align-items:center; gap:12px;">
                <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"
                    stroke-linecap="round" stroke-linejoin="round">
                    <path
                        d="M21 8a2 2 0 0 0-1-1.73l-7-4a2 2 0 0 0-2 0l-7 4A2 2 0 0 0 3 8v8a2 2 0 0 0 1 1.73l7 4a2 2 0 0 0 2 0l7-4A2 2 0 0 0 21 16Z">
                    </path>
                </svg>
                طلباتي
            </div>
            <div class="menu-item" id="tab-cart" onclick="showTab('cart')"
                style="display:flex; align-items:center; gap:12px;">
                <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"
                    stroke-linecap="round" stroke-linejoin="round">
                    <circle cx="9" cy="21" r="1"></circle>
                    <circle cx="20" cy="21" r="1"></circle>
                    <path d="M1 1h4l2.68 13.39a2 2 0 0 0 2 1.61h9.72a2 2 0 0 0 2-1.61L23 6H6"></path>
                </svg>
                سلة المشتريات
            </div>
            <div class="menu-item" id="tab-returns" onclick="showTab('returns')"
                style="display:flex; align-items:center; gap:12px;">
                <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"
                    stroke-linecap="round" stroke-linejoin="round">
                    <polyline points="23 4 23 10 17 10"></polyline>
                    <path d="M20.49 15a9 9 0 1 1-2.12-9.36L23 10"></path>
                </svg>
                المرتجعات
            </div>
            <div class="menu-item" id="tab-addresses" onclick="showTab('addresses')"
                style="display:flex; align-items:center; gap:12px;">
                <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"
                    stroke-linecap="round" stroke-linejoin="round">
                    <path d="M21 10c0 7-9 13-9 13s-9-6-9-13a9 9 0 0 1 18 0z"></path>
                    <circle cx="12" cy="10" r="3"></circle>
                </svg>
                عناويني
            </div>
            <div class="menu-item" id="tab-garage" onclick="showTab('garage')"
                style="display:flex; align-items:center; gap:12px;">
                <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"
                    stroke-linecap="round" stroke-linejoin="round">
                    <rect x="1" y="3" width="15" height="13"></rect>
                    <polygon points="16 8 20 8 23 11 23 16 16 16 16 8"></polygon>
                    <circle cx="5.5" cy="18.5" r="2.5"></circle>
                    <circle cx="18.5" cy="18.5" r="2.5"></circle>
                </svg>
                كراجي
            </div>
            <div class="menu-item" id="tab-wallet" onclick="showTab('wallet')"
                style="display:flex; align-items:center; gap:12px;">
                <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"
                    stroke-linecap="round" stroke-linejoin="round">
                    <line x1="12" y1="1" x2="12" y2="23"></line>
                    <path d="M17 5H9.5a3.5 3.5 0 0 0 0 7h5a3.5 3.5 0 0 1 0 7H6"></path>
                </svg>
                المحفظة
            </div>
            <div class="menu-item" id="tab-settings" onclick="showTab('settings')"
                style="display:flex; align-items:center; gap:12px;">
                <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"
                    stroke-linecap="round" stroke-linejoin="round">
                    <circle cx="12" cy="12" r="3"></circle>
                    <path
                        d="M19.4 15a1.65 1.65 0 0 0 .33 1.82l.06.06a2 2 0 0 1 0 2.83 2 2 0 0 1-2.83 0l-.06-.06a1.65 1.65 0 0 0-1.82-.33 1.65 1.65 0 0 0-1 1.51V21a2 2 0 0 1-2 2 2 2 0 0 1-2-2v-.09A1.65 1.65 0 0 0 9 19.4a1.65 1.65 0 0 0-1.82.33l-.06.06a2 2 0 0 1-2.83 0 2 2 0 0 1 0-2.83l.06-.06a1.65 1.65 0 0 0 .33-1.82 1.65 1.65 0 0 0-1.51-1H3a2 2 0 0 1-2-2 2 2 0 0 1 2-2h.09A1.65 1.65 0 0 0 4.6 9a1.65 1.65 0 0 0-.33-1.82l-.06-.06a2 2 0 0 1 0-2.83 2 2 0 0 1 2.83 0l.06.06a1.65 1.65 0 0 0 1.82.33H9a1.65 1.65 0 0 0 1-1.51V3a2 2 0 0 1 2-2 2 2 0 0 1 2 2v.09a1.65 1.65 0 0 0 1 1.51 1.65 1.65 0 0 0 1.82-.33l.06-.06a2 2 0 0 1 2.83 0 2 2 0 0 1 0 2.83l-.06.06a1.65 1.65 0 0 0-.33 1.82V9a1.65 1.65 0 0 0 1.51 1H21a2 2 0 0 1 2 2 2 2 0 0 1-2 2h-.09a1.65 1.65 0 0 0-1.51 1z">
                    </path>
                </svg>
                الإعدادات
            </div>
            <div class="menu-item hidden" id="tab-super-admin" onclick="window.location.href='/super-admin.html'"
                style="display:flex; align-items:center; gap:12px;">
                <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"
                    stroke-linecap="round" stroke-linejoin="round">
                    <path
                        d="M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z">
                    </path>
                </svg>
                لوحة الإدارة
            </div>
        </aside>

        <!-- Main Content Area -->
        <section class="content">

            <!-- Orders Section -->
            <div id="orders" class="content-area">
                <h2 style="margin-top: 0; margin-bottom: 1.5rem; font-weight: 800;">طلباتي السابقة</h2>
                <div class="orders-list">
                    <!-- Loaded via JS -->
                    <div style="text-align: center; padding: 40px; opacity: 0.5;">جاري تحميل طلباتك...</div>
                </div>
            </div>

            <!-- Cart Section -->
            <div id="cart" class="content-area hidden">
                <h2 style="margin-top: 0; margin-bottom: 0.5rem; font-weight: 800;">سلة المشتريات</h2>
                <p style="color:#777; margin-bottom: 1.5rem;">راجع القطع التي اخترتها قبل إتمام الدفع</p>

                <div id="cartItemsList" class="space-y-4 mb-8">
                    <!-- Loaded via JS -->
                </div>

                <div id="checkoutSection" class="hidden">
                    <div
                        style="background:white; padding:25px; border-radius:20px; border:1px solid #eee; margin-top:20px;">
                        <h3
                            style="margin-top:0; margin-bottom:1.5rem; font-weight:800; border-bottom:1px solid #f5f5f5; padding-bottom:10px;">
                            إتمام الطلب</h3>

                        <div class="grid grid-cols-1 md:grid-cols-2 gap-8">
                            <div>
                                <label
                                    style="display:block; margin-bottom:8px; font-weight:bold; font-size:0.9rem;">عنوان
                                    الشحن</label>
                                <select id="checkoutAddressSelect"
                                    style="width:100%; padding:12px; border-radius:12px; border:2px solid #f0f0f0; font-family:inherit; outline:none; transition:0.3s;">
                                    <!-- Options via JS -->
                                </select>
                                <button onclick="showTab('addresses'); openAddressModal();"
                                    style="color:var(--primary); background:none; border:none; padding:8px 0; font-size:0.85rem; cursor:pointer; text-decoration:underline;">+
                                    إضافة عنوان جديد</button>
                            </div>

                            <div>
                                <label
                                    style="display:block; margin-bottom:8px; font-weight:bold; font-size:0.9rem;">طريقة
                                    الدفع</label>
                                <div class="space-y-3">
                                    <label
                                        class="flex items-center gap-3 p-3 rounded-xl border border-gray-100 bg-gray-50 cursor-pointer hover:bg-gray-100 transition">
                                        <input type="radio" name="paymentOption" value="cod" checked>
                                        <div style="flex:1">
                                            <div style="font-weight:bold; font-size:0.9rem;">الدفع عند الاستلام</div>
                                            <div style="font-size:0.75rem; color:#888;">ادفع كاش للمندوب عند وصول الشحنة
                                            </div>
                                        </div>
                                    </label>
                                    <label
                                        class="flex items-center gap-3 p-3 rounded-xl border border-gray-100 bg-gray-50 cursor-pointer hover:bg-gray-100 transition">
                                        <input type="radio" name="paymentOption" value="wallet">
                                        <div style="flex:1">
                                            <div style="font-weight:bold; font-size:0.9rem;">المحفظة الإلكترونية</div>
                                            <div id="checkoutWalletBalance"
                                                style="font-size:0.75rem; color:var(--primary);">رصيدك: 0.00 ج.م</div>
                                        </div>
                                    </label>
                                </div>
                            </div>
                        </div>

                        <div
                            style="margin-top:1.5rem; padding-top:1.5rem; border-top:1px dashed #ddd; display:flex; justify-content:space-between; align-items:center;">
                            <div>
                                <div style="font-size:0.9rem; color:#777;">إجمالي المبلغ المستحق:</div>
                                <div id="cartTotalPrice"
                                    style="font-size:1.8rem; font-weight:900; color:var(--primary);">0 ج.م</div>
                            </div>
                            <button id="checkoutBtn" onclick="processCheckout()" class="btn-primary"
                                style="padding:15px 40px; font-size:1.1rem; border-radius:15px; box-shadow:0 10px 20px rgba(79, 70, 229, 0.2);">تأكيد
                                وطلب الآن</button>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Returns Section -->
            <div id="returns" class="content-area hidden">
                <h2 style="margin-top: 0; margin-bottom: 1.5rem; font-weight: 800;">طلبات الاسترجاع</h2>
                <div class="returns-list space-y-4">
                    <!-- Loaded via JS -->
                </div>
            </div>

            <!-- Address Section -->
            <div id="addresses" class="content-area hidden">
                <div style="display:flex; justify-content:space-between; align-items:center; margin-bottom:1.5rem;">
                    <h2 style="margin:0; font-weight:800;">عناوين التوصيل</h2>
                    <button class="btn-primary" onclick="openAddressModal()">+ إضافة عنوان</button>
                </div>
                <div class="addresses-list">
                    <!-- Loaded via JS -->
                </div>
            </div>

            <!-- Garage Section -->
            <div id="garage" class="content-area hidden">
                <div style="display:flex; justify-content:space-between; align-items:center; margin-bottom:1.5rem;">
                    <div>
                        <h2 style="margin:0; font-weight:800;">كراجي الخاص</h2>
                        <p style="color:#777; margin:5px 0 0 0; font-size:0.9rem;">أضف سياراتك لنقترح عليك قطع الغيار
                            المناسبة تماماً</p>
                    </div>
                    <button class="btn-primary" onclick="openGarageModal()">+ إضافة سيارة</button>
                </div>
                <div class="garage-list">
                    <!-- Loaded via JS -->
                </div>
            </div>

            <!-- Wallet Section -->
            <div id="wallet" class="content-area hidden">
                <h2 style="margin-top: 0; margin-bottom: 1.5rem; font-weight: 800;">محفظتي الرقمية</h2>
                <div
                    style="background: linear-gradient(135deg, var(--primary), #818cf8); color:white; padding:40px; border-radius:25px; text-align:center; box-shadow:0 15px 30px rgba(79, 70, 229, 0.2);">
                    <div style="font-size:0.9rem; opacity:0.8; margin-bottom:0.5rem;">الرصيد المتاح حالياً</div>
                    <div id="walletBalance" style="font-size:3.5rem; font-weight:900; margin:0;">0.00 <span
                            style="font-size:1.5rem;">ج.م</span></div>
                    <div style="margin-top:2rem; display:flex; justify-content:center; gap:10px;">
                        <button
                            style="background:rgba(255,255,255,0.2); border:none; color:white; padding:10px 25px; border-radius:12px; font-weight:bold; cursor:pointer;"
                            onclick="alert('شحن الرصيد متاح قريباً')">شحن المحفظة</button>
                        <button
                            style="background:white; border:none; color:var(--primary); padding:10px 25px; border-radius:12px; font-weight:bold; cursor:pointer;"
                            onclick="alert('سحب الرصيد متاح قريباً')">سحب الأرباح</button>
                    </div>
                </div>
            </div>

            <!-- Settings Section -->
            <div id="settings" class="content-area hidden">
                <h2 style="margin-top: 0; margin-bottom: 1.5rem; font-weight: 800;">الإعدادات</h2>
                <div style="background:white; padding:25px; border-radius:20px; border:1px solid #eee;">
                    <div style="padding:15px; border-bottom:1px solid #f5f5f5;">
                        <label style="display:block; font-weight:bold; margin-bottom:5px;">اللغة / Language</label>
                        <select style="width:100%; padding:10px; border-radius:8px; border:1px solid #ddd;">
                            <option>العربية (افتراضي)</option>
                            <option>English</option>
                        </select>
                    </div>
                </div>
            </div>

        </section>
    </main>

    <!-- Modals -->
    <div id="addressModal" class="hidden"
        style="position:fixed; inset:0; background:rgba(0,0,0,0.5); z-index:1000; align-items:center; justify-content:center;">
        <div style="background:white; padding:25px; border-radius:20px; width:400px;">
            <h3 style="margin-top:0;">إضافة عنوان جديد</h3>
            <input id="addrLabel" type="text" placeholder="اسم العنوان (مثلاً: المنزل، العمل)"
                style="width:100%; padding:10px; margin-bottom:10px; border-radius:8px; border:1px solid #ddd;">
            <textarea id="addrDetails" placeholder="العنوان بالتفصيل"
                style="width:100%; padding:10px; margin-bottom:10px; border-radius:8px; border:1px solid #ddd; height:80px;"></textarea>
            <label style="display:flex; align-items:center; gap:8px; margin-bottom:15px; cursor:pointer;">
                <input type="checkbox" id="addrDefault"> تعيين كعنوان افتراضي
            </label>
            <div style="display:flex; gap:10px;">
                <button onclick="saveAddress()"
                    style="flex:1; background:var(--primary); color:white; border:none; padding:10px; border-radius:8px; cursor:pointer;">حفظ</button>
                <button onclick="closeAddressModal()"
                    style="flex:1; background:#f0f2f5; border:none; padding:10px; border-radius:8px; cursor:pointer;">إلغاء</button>
            </div>
        </div>
    </div>

    <div id="garageModal" class="hidden"
        style="position:fixed; inset:0; background:rgba(0,0,0,0.5); z-index:1000; align-items:center; justify-content:center;">
        <div style="background:white; padding:25px; border-radius:20px; width:400px;">
            <h3 style="margin-top:0; display:flex; align-items:center; gap:10px;">
                <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="var(--primary)" stroke-width="2"
                    stroke-linecap="round" stroke-linejoin="round">
                    <rect x="1" y="3" width="15" height="13"></rect>
                    <polygon points="16 8 20 8 23 11 23 16 16 16 16 8"></polygon>
                    <circle cx="5.5" cy="18.5" r="2.5"></circle>
                    <circle cx="18.5" cy="18.5" r="2.5"></circle>
                </svg>
                إضافة سيارة جديدة
            </h3>
            <div style="display:grid; grid-template-columns:1fr 1fr; gap:10px;">
                <input id="carMake" type="text" placeholder="الماركة (تويوتا..)"
                    style="width:100%; padding:10px; margin-bottom:10px; border-radius:8px; border:1px solid #ddd;">
                <input id="carModel" type="text" placeholder="الموديل (كورولا..)"
                    style="width:100%; padding:10px; margin-bottom:10px; border-radius:8px; border:1px solid #ddd;">
                <input id="carYear" type="number" placeholder="سنة الصنع"
                    style="width:100%; padding:10px; margin-bottom:10px; border-radius:8px; border:1px solid #ddd;">
                <input id="carEngine" type="text" placeholder="سعة المحرك"
                    style="width:100%; padding:10px; margin-bottom:10px; border-radius:8px; border:1px solid #ddd;">
            </div>
            <div style="display:flex; gap:10px; margin-top:10px;">
                <button onclick="saveCar()"
                    style="flex:1; background:var(--primary); color:white; border:none; padding:10px; border-radius:8px; cursor:pointer;">إضافة
                    للكراج</button>
                <button onclick="closeGarageModal()"
                    style="flex:1; background:#f0f2f5; border:none; padding:10px; border-radius:8px; cursor:pointer;">إلغاء</button>
            </div>
        </div>
    </div>

    <!-- External Logic -->
    <script src="/socket.io/socket.io.js"></script>
    <script src="/assets/js/common.js"></script>
    <script src="/assets/js/profile.js"></script>
</body>

</html>